import{_ as e,c as r,a2 as d,o as a}from"./chunks/framework.Bt53DRYp.js";const g=JSON.parse('{"title":"Router Setup","description":"","frontmatter":{},"headers":[],"relativePath":"network/router.md","filePath":"network/router.md"}'),o={name:"network/router.md"};function i(n,t,l,s,h,u){return a(),r("div",null,t[0]||(t[0]=[d('<h1 id="router-setup" tabindex="-1">Router Setup <a class="header-anchor" href="#router-setup" aria-label="Permalink to &quot;Router Setup&quot;">​</a></h1><p>This page documents the configuration of the main router in your home lab infrastructure.</p><h2 id="hardware-specifications" tabindex="-1">Hardware Specifications <a class="header-anchor" href="#hardware-specifications" aria-label="Permalink to &quot;Hardware Specifications&quot;">​</a></h2><ul><li><strong>Model</strong>: Custom pfSense Appliance</li><li><strong>CPU</strong>: Intel Core i5-10500 (6 cores, 12 threads)</li><li><strong>RAM</strong>: 32GB DDR4</li><li><strong>Storage</strong>: 500GB NVMe SSD</li><li><strong>Network Interfaces</strong>: <ul><li>WAN: Intel X550-T1 (1GbE)</li><li>LAN: Intel X550-T2 (2x 10GbE)</li><li>Optional: 4-port Intel i350 (4x 1GbE)</li></ul></li></ul><h2 id="basic-configuration" tabindex="-1">Basic Configuration <a class="header-anchor" href="#basic-configuration" aria-label="Permalink to &quot;Basic Configuration&quot;">​</a></h2><h3 id="network-interfaces" tabindex="-1">Network Interfaces <a class="header-anchor" href="#network-interfaces" aria-label="Permalink to &quot;Network Interfaces&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Interface</th><th>Name</th><th>IP Address</th><th>VLAN</th><th>Purpose</th></tr></thead><tbody><tr><td>igb0</td><td>WAN</td><td>DHCP from ISP</td><td>None</td><td>Internet connection</td></tr><tr><td>ix0</td><td>LAN</td><td>10.0.10.1/24</td><td>10</td><td>Management network</td></tr><tr><td>ix0.20</td><td>SERVERS</td><td>10.0.20.1/24</td><td>20</td><td>Server network</td></tr><tr><td>ix0.30</td><td>IOT</td><td>10.0.30.1/24</td><td>30</td><td>IoT devices</td></tr><tr><td>ix0.40</td><td>GUEST</td><td>10.0.40.1/24</td><td>40</td><td>Guest network</td></tr><tr><td>ix0.50</td><td>MEDIA</td><td>10.0.50.1/24</td><td>50</td><td>Media devices</td></tr></tbody></table><h3 id="dhcp-configuration" tabindex="-1">DHCP Configuration <a class="header-anchor" href="#dhcp-configuration" aria-label="Permalink to &quot;DHCP Configuration&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Network</th><th>DHCP Range</th><th>Lease Time</th><th>DNS Servers</th></tr></thead><tbody><tr><td>Management</td><td>10.0.10.100-10.0.10.200</td><td>24 hours</td><td>10.0.10.53</td></tr><tr><td>Servers</td><td>10.0.20.100-10.0.20.200</td><td>48 hours</td><td>10.0.10.53</td></tr><tr><td>IoT</td><td>10.0.30.100-10.0.30.200</td><td>24 hours</td><td>10.0.10.53</td></tr><tr><td>Guest</td><td>10.0.40.100-10.0.40.200</td><td>4 hours</td><td>10.0.10.53</td></tr><tr><td>Media</td><td>10.0.50.100-10.0.50.200</td><td>24 hours</td><td>10.0.10.53</td></tr></tbody></table><h3 id="static-dhcp-leases" tabindex="-1">Static DHCP Leases <a class="header-anchor" href="#static-dhcp-leases" aria-label="Permalink to &quot;Static DHCP Leases&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Device</th><th>MAC Address</th><th>IP Address</th><th>Description</th></tr></thead><tbody><tr><td>Main Server</td><td>00:11:22:33:44:55</td><td>10.0.20.10</td><td>Proxmox host</td></tr><tr><td>Backup Server</td><td>00:11:22:33:44:56</td><td>10.0.20.11</td><td>Backup Proxmox host</td></tr><tr><td>NAS</td><td>00:11:22:33:44:57</td><td>10.0.20.20</td><td>TrueNAS Scale</td></tr><tr><td>Core Switch</td><td>00:11:22:33:44:58</td><td>10.0.10.2</td><td>Unifi USW-24-POE</td></tr><tr><td>Server Switch</td><td>00:11:22:33:44:59</td><td>10.0.10.3</td><td>Unifi USW-16-XG</td></tr><tr><td>Main AP</td><td>00:11:22:33:44:5A</td><td>10.0.10.4</td><td>Unifi U6-Pro</td></tr></tbody></table><h2 id="firewall-rules" tabindex="-1">Firewall Rules <a class="header-anchor" href="#firewall-rules" aria-label="Permalink to &quot;Firewall Rules&quot;">​</a></h2><h3 id="default-policies" tabindex="-1">Default Policies <a class="header-anchor" href="#default-policies" aria-label="Permalink to &quot;Default Policies&quot;">​</a></h3><ul><li>WAN: Block all incoming traffic</li><li>LAN: Allow all outgoing traffic</li><li>All other interfaces: Block by default with specific allow rules</li></ul><h3 id="wan-rules" tabindex="-1">WAN Rules <a class="header-anchor" href="#wan-rules" aria-label="Permalink to &quot;WAN Rules&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Action</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Allow</td><td>TCP</td><td>Any</td><td>WAN Address</td><td>443</td><td>HTTPS for pfSense WebGUI</td></tr><tr><td>Allow</td><td>TCP</td><td>Any</td><td>WAN Address</td><td>22</td><td>SSH (restricted by geo-IP)</td></tr><tr><td>Allow</td><td>TCP/UDP</td><td>Any</td><td>WAN Address</td><td>51820</td><td>WireGuard VPN</td></tr><tr><td>Block</td><td>Any</td><td>Any</td><td>Any</td><td>Any</td><td>Default deny rule</td></tr></tbody></table><h3 id="lan-management-rules" tabindex="-1">LAN (Management) Rules <a class="header-anchor" href="#lan-management-rules" aria-label="Permalink to &quot;LAN (Management) Rules&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Action</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Allow</td><td>Any</td><td>Management Net</td><td>Any</td><td>Any</td><td>Allow all outbound</td></tr><tr><td>Allow</td><td>TCP</td><td>Management Net</td><td>Servers Net</td><td>22, 80, 443</td><td>Management access</td></tr><tr><td>Allow</td><td>ICMP</td><td>Management Net</td><td>Any</td><td>Any</td><td>Allow ping</td></tr></tbody></table><h3 id="servers-rules" tabindex="-1">Servers Rules <a class="header-anchor" href="#servers-rules" aria-label="Permalink to &quot;Servers Rules&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Action</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Allow</td><td>TCP/UDP</td><td>Servers Net</td><td>Any</td><td>80, 443, 53</td><td>Web and DNS</td></tr><tr><td>Allow</td><td>TCP</td><td>Servers Net</td><td>Servers Net</td><td>Any</td><td>Inter-server communication</td></tr><tr><td>Allow</td><td>TCP</td><td>Media Net</td><td>Servers Net</td><td>8096</td><td>Jellyfin access</td></tr><tr><td>Block</td><td>Any</td><td>Servers Net</td><td>IoT Net</td><td>Any</td><td>Block server to IoT</td></tr></tbody></table><h3 id="iot-rules" tabindex="-1">IoT Rules <a class="header-anchor" href="#iot-rules" aria-label="Permalink to &quot;IoT Rules&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Action</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Allow</td><td>TCP/UDP</td><td>IoT Net</td><td>Any</td><td>80, 443, 53</td><td>Web and DNS</td></tr><tr><td>Allow</td><td>TCP/UDP</td><td>IoT Net</td><td>Servers Net</td><td>8123, 1883</td><td>Home Assistant, MQTT</td></tr><tr><td>Block</td><td>Any</td><td>IoT Net</td><td>Management Net</td><td>Any</td><td>Block IoT to management</td></tr><tr><td>Block</td><td>Any</td><td>IoT Net</td><td>Guest Net</td><td>Any</td><td>Block IoT to guest</td></tr></tbody></table><h3 id="guest-rules" tabindex="-1">Guest Rules <a class="header-anchor" href="#guest-rules" aria-label="Permalink to &quot;Guest Rules&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Action</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Allow</td><td>TCP/UDP</td><td>Guest Net</td><td>Any</td><td>80, 443, 53</td><td>Web and DNS</td></tr><tr><td>Block</td><td>Any</td><td>Guest Net</td><td>RFC1918</td><td>Any</td><td>Block access to private networks</td></tr></tbody></table><h2 id="nat-configuration" tabindex="-1">NAT Configuration <a class="header-anchor" href="#nat-configuration" aria-label="Permalink to &quot;NAT Configuration&quot;">​</a></h2><h3 id="port-forwards" tabindex="-1">Port Forwards <a class="header-anchor" href="#port-forwards" aria-label="Permalink to &quot;Port Forwards&quot;">​</a></h3><table tabindex="0"><thead><tr><th>WAN Port</th><th>Protocol</th><th>NAT IP</th><th>NAT Port</th><th>Description</th></tr></thead><tbody><tr><td>443</td><td>TCP</td><td>10.0.20.30</td><td>443</td><td>Reverse proxy (HTTPS)</td></tr><tr><td>51820</td><td>UDP</td><td>10.0.10.1</td><td>51820</td><td>WireGuard VPN</td></tr></tbody></table><h3 id="outbound-nat" tabindex="-1">Outbound NAT <a class="header-anchor" href="#outbound-nat" aria-label="Permalink to &quot;Outbound NAT&quot;">​</a></h3><ul><li>Default: Automatic outbound NAT for all interfaces</li><li>Custom rule for VPN traffic to use dedicated IP (if applicable)</li></ul><h2 id="vpn-configuration" tabindex="-1">VPN Configuration <a class="header-anchor" href="#vpn-configuration" aria-label="Permalink to &quot;VPN Configuration&quot;">​</a></h2><h3 id="wireguard" tabindex="-1">WireGuard <a class="header-anchor" href="#wireguard" aria-label="Permalink to &quot;WireGuard&quot;">​</a></h3><ul><li><strong>Interface</strong>: wg0</li><li><strong>Listen Port</strong>: 51820</li><li><strong>Tunnel Network</strong>: 10.100.100.0/24</li><li><strong>Peers</strong>: [List of authorized peers with public keys]</li></ul><h3 id="openvpn-backup" tabindex="-1">OpenVPN (Backup) <a class="header-anchor" href="#openvpn-backup" aria-label="Permalink to &quot;OpenVPN (Backup)&quot;">​</a></h3><ul><li><strong>Protocol</strong>: UDP</li><li><strong>Port</strong>: 1194</li><li><strong>Tunnel Network</strong>: 10.200.200.0/24</li><li><strong>Authentication</strong>: Certificate + Username/Password</li><li><strong>Encryption</strong>: AES-256-GCM</li></ul><h2 id="dns-configuration" tabindex="-1">DNS Configuration <a class="header-anchor" href="#dns-configuration" aria-label="Permalink to &quot;DNS Configuration&quot;">​</a></h2><ul><li><strong>DNS Resolver</strong>: Unbound (built-in)</li><li><strong>Forwarding Mode</strong>: Enable forwarding to Pi-hole (10.0.10.53)</li><li><strong>DNSSEC</strong>: Enabled</li><li><strong>DNS over TLS</strong>: Enabled (Cloudflare)</li><li><strong>Local Domain</strong>: home.lab</li></ul><h2 id="advanced-features" tabindex="-1">Advanced Features <a class="header-anchor" href="#advanced-features" aria-label="Permalink to &quot;Advanced Features&quot;">​</a></h2><h3 id="traffic-shaping" tabindex="-1">Traffic Shaping <a class="header-anchor" href="#traffic-shaping" aria-label="Permalink to &quot;Traffic Shaping&quot;">​</a></h3><ul><li><strong>WAN Bandwidth</strong>: 1000Mbps down / 50Mbps up</li><li><strong>Priority Queue</strong>: <ol><li>VoIP traffic</li><li>Interactive traffic (SSH, RDP)</li><li>Standard web browsing</li><li>Bulk transfers (updates, backups)</li><li>P2P traffic (lowest priority)</li></ol></li></ul><h3 id="ids-ips" tabindex="-1">IDS/IPS <a class="header-anchor" href="#ids-ips" aria-label="Permalink to &quot;IDS/IPS&quot;">​</a></h3><ul><li><strong>Engine</strong>: Suricata</li><li><strong>Rule Sets</strong>: ET Open, Snort Community</li><li><strong>Mode</strong>: IPS (block detected threats)</li><li><strong>Interfaces</strong>: WAN, Guest</li></ul><h3 id="monitoring" tabindex="-1">Monitoring <a class="header-anchor" href="#monitoring" aria-label="Permalink to &quot;Monitoring&quot;">​</a></h3><ul><li><strong>NetFlow</strong>: Enabled, sending to Monitoring VM</li><li><strong>SNMP</strong>: Enabled for Prometheus monitoring</li><li><strong>Dashboard Graphs</strong>: CPU, Memory, Network throughput</li></ul><h2 id="backup-and-recovery" tabindex="-1">Backup and Recovery <a class="header-anchor" href="#backup-and-recovery" aria-label="Permalink to &quot;Backup and Recovery&quot;">​</a></h2><h3 id="configuration-backup" tabindex="-1">Configuration Backup <a class="header-anchor" href="#configuration-backup" aria-label="Permalink to &quot;Configuration Backup&quot;">​</a></h3><ul><li><strong>Schedule</strong>: Daily at 2 AM</li><li><strong>Retention</strong>: 30 days</li><li><strong>Location</strong>: Backup Server (10.0.20.11)</li><li><strong>Encryption</strong>: AES-256</li></ul><h3 id="recovery-procedure" tabindex="-1">Recovery Procedure <a class="header-anchor" href="#recovery-procedure" aria-label="Permalink to &quot;Recovery Procedure&quot;">​</a></h3><ol><li>Install fresh pfSense on replacement hardware</li><li>Complete initial setup with temporary settings</li><li>Import configuration backup file</li><li>Verify all interfaces and services</li></ol><h2 id="maintenance-notes" tabindex="-1">Maintenance Notes <a class="header-anchor" href="#maintenance-notes" aria-label="Permalink to &quot;Maintenance Notes&quot;">​</a></h2><ul><li><strong>Firmware Updates</strong>: Schedule for 3rd Sunday of each month, 2 AM</li><li><strong>Configuration Changes</strong>: Document all changes in this wiki</li><li><strong>Performance Testing</strong>: Run iperf3 tests monthly to verify throughput</li></ul>',50)]))}const b=e(o,[["render",i]]);export{g as __pageData,b as default};
